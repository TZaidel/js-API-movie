{"mappings":"AACA,MAAMA,EAAOC,SAASC,cAAc,SACfD,SAASC,cAAc,kBAC5BD,SAASC,cAAc,iBACvC,IAEIC,EAFAC,EAAO,EA8BX,SAASC,IACL,MAAMC,EAAS,IAAIC,gBAAgB,CACnCC,QA3BY,mCA4BZC,KAAML,IAEN,OAAOM,MAAM,oDAA0BJ,KAClCK,MAAKC,IACF,IAAKA,EAAOC,GACZ,MAAM,IAAIC,MAAMF,EAAOG,YAEvB,OAAOH,EAAOI,MAAM,G,CAchC,SAASC,EAAaC,GAClB,OAAOA,EAAIC,KAAI,EAACC,GAAEA,EAAEC,MAAEA,EAAKC,aAAEA,EAAYC,YAAEA,KACvC,WAAWH,sEACgCG,oBACrCF,mCACYC,EAAaE,QAAQ,kFAE/BC,KAAK,G,CAGrB,SAASC,IACWzB,SAAS0B,iBAAiB,aAClCC,SAASC,IACbA,EAAOC,iBAAiB,QAASC,EAAgB,G,CAIzD,SAASA,EAAgBC,GACrB,MAAMC,EAAgBD,EAAME,OAAOC,QAAQ,SA5B/C,IAAwBC,MA6BJH,EAAcb,GA5BvBV,MAAM,sCAAqB0B,8CAC7BzB,MAAKC,IACF,IAAKA,EAAOC,GACZ,MAAM,IAAIC,MAAMF,EAAOG,YAEvB,OAAOH,EAAOI,MAAM,KAwBvBL,MAAK0B,IACFC,QAAQC,IAAIF,GACZlC,EAAWqC,cAAcC,OAAO,qFACeJ,EAAId,sCACzCc,EAAIhB,kCACLgB,EAAIK,wCAEbvC,EAASwC,MAAM,IAElBC,OAAMC,IACHP,QAAQC,IAAI,gBAAiBM,EAAM,G,CAM/CC,OAAOhB,iBAAiB,WAExB,SAAuBE,GACA,WAAfA,EAAMe,MAAoB5C,GAC1BA,EAAS6C,O;;;;GAwDjB,MAAMC,EAAQhD,SAASC,cAAc,UAO/BgD,EAAW,IAAIC,sBAErB,SAA0BC,EAASC,GAC/Bf,QAAQC,IAAIa,GACZA,EAAQxB,SAAQ0B,IACRA,EAAMC,iBACNnD,GAAQ,EACRC,IAAiBM,MAAK6C,IAClBlB,QAAQC,IAAIiB,GACZxD,EAAKyD,mBAAmB,YAAaxC,EAAauC,EAAKE,UACvDhC,IACI8B,EAAK/C,MAAQ+C,EAAKG,aAClBN,EAASO,UAAUN,EAAMpB,OAAO,I,MAlBpC,CACZ2B,KAAM,KACNC,WAAY,QACZC,UAAW,IAsBf1D,EAAWD,EAAK,GACXO,MAAK6C,IACFlB,QAAQC,IAAIiB,GACZxD,EAAKyD,mBAAmB,YAAaxC,EAAauC,EAAKE,UACvDhC,IAEI8B,EAAK/C,KAAO,GACZyC,EAASc,QAAQf,EAAM,IAI9BL,OAAMC,GAAQP,QAAQC,IAAI,wBAAyBM","sources":["src/movie/movie.js"],"sourcesContent":["import axios from \"axios\";\nconst list = document.querySelector('.list')\nconst btnContainer = document.querySelector('.btn-container')\nconst btnLoad = document.querySelector('.js-load-more')\nlet page = 1\nlet totalPages=2\nlet instance\nconst BASE_URL = \"https://api.themoviedb.org/3\"\nconst ENDPOINT = \"/trending/movie/week\"\nconst API_KEY = \"d23ee7111563012a1c81428dff1d7a5f\"\n\n// btnLoad.addEventListener('click', onLoadMoreClick)\n\n// fetchMovie(page=1)\n//     .then(data => {\n//         console.log(data)\n//         list.insertAdjacentHTML(\"beforeend\", createMarkup(data.results))\n//         addEventListener()\n//     })\n//     .catch(error=> console.log('error in fetchMovie()', error))\n    \n// function onLoadMoreClick(event) {\n//     page +=1\n//     fetchMovie(page)\n//         .then(data => {\n//             console.log(data)\n//             list.insertAdjacentHTML(\"beforeend\", createMarkup(data.results))\n//             if (data.page >= data.total_pages) {\n//                 btnLoad.style.display= \"none\"\n//             }\n//         })\n\n// }\n\nfunction fetchMovie() {\n    const params = new URLSearchParams({\n    api_key: API_KEY,\n    page: page\n})\n    return fetch(`${BASE_URL}${ENDPOINT}?${params}`)\n        .then(result => {\n            if (!result.ok) {\n            throw new Error(result.statusText)\n            }\n            return result.json()\n    })\n}\n\nfunction fetchMovieInfo(movieId) {\n    return fetch(`${BASE_URL}/movie/${movieId}?api_key=${API_KEY}`)\n        .then(result => {\n            if (!result.ok) {\n            throw new Error(result.statusText)\n            }\n            return result.json()\n        })\n}\n\nfunction createMarkup(arr) {\n    return arr.map(({ id, title, vote_average, poster_path }) =>\n        `<li id=\"${id}\" class=\"item\">\n        <img src=\"https://image.tmdb.org/t/p/w200${poster_path}\">\n        <h2>${title}</h2>\n        <p class=\"vote\">${vote_average.toFixed(1)}</p>\n        <button class=\"more-btn\">Read more...</button>\n        </li>`).join('')\n}\n\nfunction addEventListener() {\n    const moreBtn = document.querySelectorAll('.more-btn')\n    moreBtn.forEach((button) => {\n        button.addEventListener('click', onReadMoreClick)\n    })\n}\n\nfunction onReadMoreClick(event) {\n    const selectedMovie = event.target.closest('.item')\n    fetchMovieInfo(+selectedMovie.id)\n        .then(res =>  {\n            console.log(res)\n            instance = basicLightbox.create(`<div class=\"modal-box\">\n                <img src=\"https://image.tmdb.org/t/p/w200${res.poster_path}\">\n                <h2>${res.title}</h2>\n                <p>${res.overview}</p></div>\n                `)\n            instance.show()  \n        })\n        .catch(error => {\n            console.log('error onClick', error)\n        })\n}\n\n\n\nwindow.addEventListener('keydown', onEscapePress)\n\nfunction onEscapePress(event) {\n    if (event.code === \"Escape\"&& instance)\n        instance.close()\n}\n\n\n\n\n\n//!axios\n// function serviceMovie(page = 1) {\n//         const BASE_URL = \"https://api.themoviedb.org/3\"\n//     const ENDPOINT = \"/trending/movie/week\"\n//     const API_KEY = \"d23ee7111563012a1c81428dff1d7a5f\"\n\n//     const params = new URLSearchParams({\n//         api_key: API_KEY,\n//         page: page\n//     })\n\n//     return axios.get(`${BASE_URL}${ENDPOINT}?${params}`)\n//         .then(resp =>{\n//             console.log(resp)\n//             return resp.data\n//         })\n//         .catch(err => {\n//         throw new Error(err)\n//     })\n// }\n//!--------async-await\n// async function render() {\n//     try {\n//         const data = await fetchMovie()\n//         list.insertAdjacentHTML(\"beforeend\", createMarkup(data.results))\n\n//     } catch(error) {\n//         console.log('new Error')\n//     }\n// }\n\n// async function fetchMovie() {\n//         const params = new URLSearchParams({\n//     api_key: API_KEY,\n//     page: page\n//         })\n//     try {\n//         const res = await axios(`${BASE_URL}${ENDPOINT}?${params}`)\n//         console.log(res)\n//     return await res.data\n//     } catch (error) {\n//         throw new Error(error)\n//     }\n// }\n// render()\n\n\n//!---------infinity scroll\n\nconst guard = document.querySelector('.guard')\nconst options = {\n    root: null,\n    rootMargin: '200px',\n    threshold: 0\n}\n\nconst observer = new IntersectionObserver(handlePagination, options)\n\nfunction handlePagination(entries, observer) {\n    console.log(entries)\n    entries.forEach(entry => {\n        if (entry.isIntersecting) {\n            page += 1\n            fetchMovie(page).then(data => {\n                console.log(data)\n                list.insertAdjacentHTML('beforeend', createMarkup(data.results))\n                addEventListener()\n                if (data.page >= data.total_pages) {\n                    observer.unobserve(entry.target)\n                }\n            })\n        }\n})\n}\n\nfetchMovie(page=1)\n    .then(data => {\n        console.log(data)\n        list.insertAdjacentHTML(\"beforeend\", createMarkup(data.results))\n        addEventListener()\n\n        if (data.page < 3) {\n            observer.observe(guard)\n        }\n\n    })\n    .catch(error=> console.log('error in fetchMovie()', error))\n    \n\n\n\n\n\n\n\n"],"names":["$a38447244121062d$var$list","document","querySelector","$a38447244121062d$var$instance","$a38447244121062d$var$page","$a38447244121062d$var$fetchMovie","params","URLSearchParams","api_key","page","fetch","then","result","ok","Error","statusText","json","$a38447244121062d$var$createMarkup","arr","map","id","title","vote_average","poster_path","toFixed","join","$a38447244121062d$var$addEventListener","querySelectorAll","forEach","button","addEventListener","$a38447244121062d$var$onReadMoreClick","event","selectedMovie","target","closest","movieId","res","console","log","basicLightbox","create","overview","show","catch","error","window","code","close","$a38447244121062d$var$guard","$a38447244121062d$var$observer","IntersectionObserver","entries","observer1","entry","isIntersecting","data","insertAdjacentHTML","results","total_pages","unobserve","root","rootMargin","threshold","observe"],"version":3,"file":"movie.c9587686.js.map"}